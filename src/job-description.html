<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="shared-styles.html">
<dom-module id="job-description">
    <template>
        <style include="shared-styles">
         :host {
            display: block;

            padding: 10px;
        }

        .flex-horizontal-with-ratios {
            @apply --layout-horizontal;
        }

        .flexchild {
            @apply --layout-flex;
        }

        .flex2child {
            @apply --layout-flex-2;
        }

        .flex3child {
            @apply --layout-flex-3;
        }

        .flex6child {
            @apply --layout-flex-6;
        }

        .centered-box {
            @apply(--layout-horizontal);
            @apply(--layout-center-justified);
            width: 100%;
        }
        </style>
        <h2>Job Details</h2>
        <div class="container flex-horizontal-with-ratios">
            <div class="flex2child">
                <paper-listbox slot="dropdown-content">
                    <paper-item>
                        <paper-item-body two-line>
                            <div secondary>Customer Name</div>
                            <div>{{job.customer.name}}</div>
                        </paper-item-body>
                    </paper-item>
                </paper-listbox>
            </div>
            <div class="flexchild">
                <paper-listbox slot="dropdown-content">
                    <paper-item>
                        <paper-item-body two-line>
                            <div secondary>Job type</div>
                            <div>{{job.jobType}}</div>
                        </paper-item-body>
                    </paper-item>
                </paper-listbox>
            </div>
            <div class="flexchild">
                <paper-listbox slot="dropdown-content">
                    <paper-item>
                        <paper-item-body two-line>
                            <div secondary>Machine</div>
                            <div>{{job.machine.name}}</div>
                        </paper-item-body>
                    </paper-item>
                </paper-listbox>
            </div>
        </div>
        <div class="container flex-horizontal-with-ratios">
            <div class="flexchild">
                <paper-listbox slot="dropdown-content">
                    <paper-item>
                        <paper-item-body two-line>
                            <div secondary>Address</div>
                            <div>{{job.customer.address}}</div>
                        </paper-item-body>
                    </paper-item>
                </paper-listbox>
            </div>
            <div class="flexchild">
                <paper-listbox slot="dropdown-content">
                    <paper-item>
                        <paper-item-body two-line>
                            <div secondary>Engineer</div>
                            <div>{{job.engineer.first_name}} {{job.customer.last_name}}</div>
                        </paper-item-body>
                    </paper-item>
                </paper-listbox>
            </div>
        </div>
        <h2>Change Log</h2>
        <template is="dom-repeat" items="{{job.history}}" as="history">

        <div class="container flex-horizontal-with-ratios">
            <div class="flexchild">
                <paper-listbox slot="dropdown-content">
                    <paper-item>
                        <paper-item-body two-line>
                            <div secondary>Date</div>
                            <div>{{getFormatedDate(history.updateTime)}}</div>
                        </paper-item-body>
                    </paper-item>
                </paper-listbox>
            </div>
            <div class="flexchild">
                <paper-listbox slot="dropdown-content">
                    <paper-item>
                        <paper-item-body two-line>
                            <div secondary>From Status</div>
                            <div>{{history.fromStatus}}</div>
                        </paper-item-body>
                    </paper-item>
                </paper-listbox>
            </div>
            <div class="flexchild">
                <paper-listbox slot="dropdown-content">
                    <paper-item>
                        <paper-item-body two-line>
                            <div secondary>To Status</div>
                            <div>{{history.toStatus}}</div>
                        </paper-item-body>
                    </paper-item>
                </paper-listbox>
            </div>
            <div class="flex2child">
                <paper-listbox slot="dropdown-content">
                    <paper-item>
                        <paper-item-body two-line>
                            <div secondary>Notes</div>
                            <div style="max-width:400px;">{{history.notes}}</div>
                        </paper-item-body>
                    </paper-item>
                </paper-listbox>
            </div>
        </div>
        </template>
    </template>
    <script>
    class JobDesc extends Polymer.Element {
        static get is() { return 'job-description'; }

        static get properties() {
            return {
                job: {
                    type: Object,
                    reflectToAttribute: true
                }
            }
        }

        getFormatedDate(date){
          console.log('getFormatedDate', date);
          if(date){
            return moment(date).format('ddd DD MMM YYYY h:mm a');
          }else{
            return "-- --- ---- -:-- -";
          }
        }
    }

    window.customElements.define(JobDesc.is, JobDesc);
    </script>
</dom-module>